<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ジョージア法人設立LP</title>

<!-- 差し替え確認用ピンクバー（不要なら削除） -->
<style>html{border-top:8px solid #ff0077!important}</style>

<!-- 既存CSS（そのまま） -->
<link rel="stylesheet" href="./style.css?v=20250816-04" id="main-css">

<!-- 追加スタイル：スマホ最適化＋CTA＋ハンバーガー -->
<style>
  /* ===== セーフエリア対応（iPhone等） ===== */
  :root{
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-right: env(safe-area-inset-right, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --cta-h: 72px;
  }

  html,body{ margin:0; padding:0 }
  /* 本文下は「固定CTAの高さ＋セーフエリアぶん」確保して常に重なり防止 */
  body{ padding-bottom: calc(var(--cta-h) + var(--safe-bottom)); }

  /* アコーディオンの体裁（既存と同等） */
  details summary{
    padding:1rem 1.2rem; cursor:pointer; list-style:none;
    border:1px solid #e5e7eb; border-radius:10px; background:#fff; font-weight:700;
  }
  details[open] summary{ background:#f8fafc; border-bottom-left-radius:0; border-bottom-right-radius:0 }
  details .content{
    border:1px solid #e5e7eb; border-top:0; border-bottom-left-radius:10px; border-bottom-right-radius:10px;
    padding:1rem 1.2rem .9rem; background:#fff;
  }
  .accordion>details{ margin:.55rem 0!important }

  /* 見出しが大きすぎる端末での調整 */
  @media (max-width:480px){
    h2{ font-size: clamp(18px, 5.6vw, 22px); line-height:1.28; margin: 0 0 .8rem; }
  }

  /* ===== 下部固定CTA ===== */
  .fixed-cta{
    position:fixed; left:0; right:0; bottom:0; z-index:9998;
    background:#ffffffcc; backdrop-filter:saturate(140%) blur(8px);
    border-top:1px solid rgba(0,0,0,.06);
    /* iOSのホームバー分を足す */
    padding-bottom: var(--safe-bottom);
  }
  .fixed-cta .row{
    max-width:64rem; margin:0 auto;
    display:flex; gap:.6rem; align-items:center; justify-content:flex-end;
    padding:.6rem 1rem; min-height:var(--cta-h);
  }
  .btn{
    display:inline-flex; gap:.5rem; align-items:center; justify-content:center;
    border-radius:10px; padding:.55rem .9rem; font-weight:700; border:1px solid transparent;
    text-decoration:none; cursor:pointer; white-space:nowrap; user-select:none;
  }
  .btn.secondary{ background:#1f2937; color:#fff }
  .btn.success{ background:#10b981; color:#fff }
  .btn.neutral{ background:#e5e7eb; color:#111827 }
  .btn:hover{ opacity:.92 }

  /* ===== 右上ハンバーガー（ビジネスグレー／14px） ===== */
  .menu-button{
    position:fixed; 
    top: calc(10px + var(--safe-top));
    right: calc(10px + var(--safe-right));
    z-index:10000;
    display:inline-flex; align-items:center; justify-content:center;
    width:48px; height:48px; border-radius:12px; background:#111827; color:#fff;
    box-shadow:0 4px 14px rgba(0,0,0,.15); border:1px solid rgba(255,255,255,.08);
  }
  .menu-button .bars{ display:block; width:28px; height:20px; position:relative; }
  .menu-button .bars::before,
  .menu-button .bars::after,
  .menu-button .bars span{
    content:""; position:absolute; left:0; right:0; height:2px; background:#fff; border-radius:2px;
  }
  .menu-button .bars::before{ top:0 }
  .menu-button .bars span{ top:9px }
  .menu-button .bars::after{ bottom:0 }

  .menu-wrap{ position:fixed; inset:0; z-index:9999; pointer-events:none }
  .menu-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.35); opacity:0; transition:opacity .18s ease; backdrop-filter:blur(1px) }
  .menu-panel{
    position:absolute; top:0; right:0; height:100%; width:min(420px,92vw);
    background:#f5f7fa; color:#0b1220; border-left:1px solid #e5e7eb;
    box-shadow:-16px 0 40px rgba(0,0,0,.12);
    transform:translateX(100%); transition:transform .22s ease;
    font-size:14px; line-height:1.38;
  }
  .menu-head{
    display:flex; align-items:center; justify-content:space-between; gap:8px;
    padding:12px 14px; border-bottom:1px solid #e5e7eb; background:#fff; position:sticky; top:0; z-index:2;
  }
  .menu-title{ font-weight:800; color:#111827 }
  .menu-close{
    width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center;
    border-radius:10px; border:1px solid #e5e7eb; background:#fff; color:#111827;
  }
  .menu-close:hover{ background:#f3f4f6 }

  .menu-groups{ overflow:auto; height:calc(100% - 60px); padding:10px 0; }
  .menu-group{ padding:8px 10px 6px; }
  .menu-group h4{ margin:0 0 6px; padding:0 6px; font-size:.92rem; color:#111827; font-weight:700; opacity:.9 }
  .menu-list{ list-style:none; margin:0; padding:0 }
  .menu-list li a{
    display:block; padding:7px 10px; margin:0 6px 6px; border-radius:8px; text-decoration:none;
    color:#334155; background:#fff; border:1px solid #e5e7eb;
  }
  .menu-list li a:hover{ background:#eef2f7; border-color:#d4d8de }

  /* オープン状態 */
  html.menu-open .menu-wrap{ pointer-events:auto }
  html.menu-open .menu-backdrop{ opacity:1 }
  html.menu-open .menu-panel{ transform:none }
  html.menu-open, html.menu-open body{ overflow:hidden }

  /* セクション境界の微調整（KYC⇄料金の間も統一） */
  #corp-setup{ padding-bottom:2.0rem!important }
  #plans{ padding-top:.75rem!important }
</style>
</head>
<body>

<!-- ページ最上部アンカー -->
<div id="page-top" aria-hidden="true"></div>

<!-- 右上ハンバーガー -->
<button class="menu-button" id="menuBtn" aria-controls="menuDrawer" aria-expanded="false" aria-label="メニューを開閉">
  <span class="bars"><span></span></span>
</button>
<nav class="menu-wrap" id="menuDrawer" aria-hidden="true">
  <div class="menu-backdrop" id="menuBackdrop"></div>
  <aside class="menu-panel" role="dialog" aria-modal="true" aria-label="目次（各セクションへ移動）">
    <div class="menu-head">
      <strong class="menu-title">目次（各セクションへ移動）</strong>
      <button class="menu-close" id="menuClose" aria-label="閉じる">×</button>
    </div>
    <div class="menu-groups" id="menuGroups"><!-- JSが自動生成 --></div>
  </aside>
</nav>

<!-- === 本文（※ここに既存のdetails群をそのまま貼り戻してください） === -->
<section id="corp-setup" class="container mx-auto max-w-4xl px-4 py-16">
  <h2 class="text-2xl md:text-3xl font-bold mb-6">ジョージア法人設立｜OECD・PwC準拠／MoU契約／完全オンライン</h2>
  <div class="space-y-3 accordion">
    <!-- あなたの details 群（法人） -->
  </div>
</section>

<section id="plans" class="container mx-auto max-w-4xl px-4 py-12">
  <div class="space-y-3 accordion">
    <!-- あなたの 料金プラン details 群（※子項目はメニューから自動除外） -->
  </div>
</section>

<section id="sole-setup" class="container mx-auto max-w-4xl px-4 py-16">
  <h2 class="text-2xl md:text-3xl font-bold mb-6">ジョージア個人事業主｜税率1%（条件あり）／完全オンライン</h2>
  <div class="space-y-3 accordion">
    <!-- あなたの details 群（IE+SBS） -->
  </div>
</section>

<section id="personal-account" class="container mx-auto max-w-4xl px-4 py-16">
  <h2 class="text-2xl md:text-3xl font-bold mb-6">ジョージア銀行｜個人口座開設サポート（非居住者OK）</h2>
  <div class="space-y-3 accordion">
    <!-- あなたの details 群（銀行） -->
  </div>
</section>

<section id="disclaimer" class="container mx-auto max-w-4xl px-4 py-8 text-sm">
  <h2 class="smallish">免責事項・キャンセルポリシー（重要）</h2>
  <!-- 免責本文 -->
</section>

<!-- 画面最下部 固定CTA -->
<div class="fixed-cta" id="ctaBar" role="region" aria-label="お申込みと相談の操作バー">
  <div class="row">
    <a class="btn neutral" id="toTop" href="#page-top" aria-label="ページ上部へ">トップへ</a>
    <a class="btn secondary" href="https://line.me/R/ti/p/@georgia-tax" target="_blank" rel="noopener">相談はこちら</a>
    <a class="btn success" id="applyNow" href="#" rel="noopener">今すぐ申し込み</a>
  </div>
</div>

<script>
  /* ▼▼ フォームURLをあなたの実URLに差し替え ▼▼ */
  const FORM_URL = 'REPLACE_ME_WITH_YOUR_GOOGLE_FORM_URL';
  /* ▲▲ ここだけ編集 ▲▲ */

  /* ページ内リンク：対象が存在するときのみスムーススクロール */
  document.addEventListener('click', (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;
    const id = a.getAttribute('href');
    const target = document.querySelector(id);
    if (!target) return;            // 存在しないアンカーは通常動作
    e.preventDefault();
    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    const first = target.querySelector('details');
    if (first && !first.open) first.open = true;
    history.pushState(null, '', id);
  });

  /* 「トップへ」確実動作（アンカーがなくても上へ） */
  document.getElementById('toTop')?.addEventListener('click', (e)=>{
    if (!document.querySelector('#page-top')) {
      e.preventDefault();
      window.scrollTo({top:0, behavior:'smooth'});
    }
  });

  /* CTA高さに合わせて本文下余白を調整（重なり防止） */
  const adjustCtaPadding = () => {
    const bar = document.getElementById('ctaBar');
    if (!bar) return;
    const h = Math.ceil(bar.getBoundingClientRect().height);
    document.documentElement.style.setProperty('--cta-h', h + 'px');
  };
  window.addEventListener('load', adjustCtaPadding);
  window.addEventListener('resize', adjustCtaPadding);

  /* 申込ボタン：未設定なら警告、設定済みなら新規タブで開く */
  document.getElementById('applyNow')?.addEventListener('click', (e) => {
    e.preventDefault();
    if (!FORM_URL || /REPLACE_ME/i.test(FORM_URL)) {
      alert('フォームURLが未設定です。コード上部の FORM_URL を正しい Google フォームURLに差し替えてください。');
      return;
    }
    window.open(FORM_URL, '_blank', 'noopener');
  });

  /* ===== ハンバーガー生成・開閉 ===== */
  const btn     = document.getElementById('menuBtn');
  const drawer  = document.getElementById('menuDrawer');
  const closeBt = document.getElementById('menuClose');
  const overlay = document.getElementById('menuBackdrop');
  const groupsRoot = document.getElementById('menuGroups');

  const openMenu  = () => { document.documentElement.classList.add('menu-open');  drawer.setAttribute('aria-hidden','false');  btn.setAttribute('aria-expanded','true'); };
  const closeMenu = () => { document.documentElement.classList.remove('menu-open'); drawer.setAttribute('aria-hidden','true');   btn.setAttribute('aria-expanded','false'); };

  btn.addEventListener('click', () => {
    document.documentElement.classList.contains('menu-open') ? closeMenu() : openMenu();
  });
  closeBt.addEventListener('click', closeMenu);
  overlay.addEventListener('click', closeMenu);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMenu(); });

  /* メニュー項目を自動生成（料金の子プランは除外） */
  const sections = [
    { id: 'corp-setup',  title: 'ジョージア法人設立' },
    { id: 'plans',       title: '料金プラン' },
    { id: 'sole-setup',  title: 'ジョージア個人事業主' },
    { id: 'personal-account', title: 'ジョージア銀行' },
    { id: 'disclaimer',  title: '免責事項' }
  ];
  const excludeTitles = ['基本プラン','設立＋LPパック','設立+LPパック','フルサポートパック'];

  const slug = (t) => t.toLowerCase()
    .replace(/[（）()［\[\]【】]/g,' ')
    .replace(/[^\w\u3040-\u30ff\u3400-\u9fff]+/g,'-')
    .replace(/-+/g,'-').replace(/^-|-$/g,'');

  let globalIndex = 1;

  function buildMenu(){
    const frag = document.createDocumentFragment();
    sections.forEach(sec=>{
      const root = document.getElementById(sec.id);
      if(!root) return;
      const details = root.querySelectorAll('details');
      if(!details.length) return;

      const wrap = document.createElement('div');
      wrap.className = 'menu-group';

      const h4 = document.createElement('h4');
      h4.textContent = sec.title || root.querySelector('h2')?.textContent?.trim() || 'セクション';
      wrap.appendChild(h4);

      const ul = document.createElement('ul');
      ul.className = 'menu-list';

      details.forEach(d=>{
        const s = d.querySelector('summary');
        const title = s?.textContent?.trim() || '項目';
        if (excludeTitles.some(x => title.includes(x))) return;           // 料金の子項目は除外
        if (!d.id){ d.id = `acc-${globalIndex}-${slug(title) || 'item'}`; globalIndex++; }

        const li = document.createElement('li');
        const a  = document.createElement('a');
        a.href = `#${d.id}`;
        a.textContent = title;
        a.addEventListener('click',(e)=>{
          e.preventDefault();
          closeMenu();
          d.open = true;
          d.scrollIntoView({behavior:'smooth', block:'start'});
          history.pushState(null,'',`#${d.id}`);
        });
        li.appendChild(a);
        ul.appendChild(li);
      });

      wrap.appendChild(ul);
      frag.appendChild(wrap);
    });
    groupsRoot.textContent = '';
    groupsRoot.appendChild(frag);
  }

  document.addEventListener('DOMContentLoaded', buildMenu);
</script>
</body>
</html>
